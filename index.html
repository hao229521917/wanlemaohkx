
<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>ç©äº†ä¹ˆ Â· ä¸å¯é€†å®¡åˆ¤æ¨¡å¼</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  background:#07090c;
  color:#eaecef;
  font-family:-apple-system,BlinkMacSystemFont,"PingFang SC",sans-serif;
  text-align:center;
  margin:0;
}
h1{margin-top:18px;}
#panel{font-size:15px;margin:10px;}
.btn{
  padding:14px 22px;
  margin:10px;
  font-size:18px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}
#cut{background:#f6465d;color:#fff;}
#hold{background:#0ecb81;color:#000;}
#start{background:#f0b90b;font-size:20px;}
#log{margin:15px;color:#aaa;min-height:70px;white-space:pre-line;}
#verdict{
  margin:20px;
  padding:16px;
  border:1px solid #333;
  border-radius:10px;
  display:none;
  background:#0b0e11;
}
.hidden{display:none;}
</style>
</head>
<body>

<h1>ğŸ® ç©äº†ä¹ˆ Â· ä¸å¯é€†å®¡åˆ¤æ¨¡å¼</h1>

<div id="panel">
è´¦æˆ·ï¼š<span id="account">100</span>% |
æœ€å¤§å›æ’¤ï¼š<span id="dd">0</span>% |
ä»“ä½ä¸Šé™ï¼š<span id="cap">100</span>% |
äº¤æ˜“æ•°ï¼š<span id="count">0</span>
</div>

<button id="start" class="btn">ç­¾ç½²äº¤æ˜“å‘˜å£°æ˜å¹¶å¼€å§‹</button><br>
<button id="cut" class="btn hidden">æ­¢æŸ</button>
<button id="hold" class="btn hidden">æ‰›å•</button>

<div id="log"></div>
<div id="verdict"></div>

<script>
let account=100;
let peak=100;
let maxDD=0;
let count=0;
let cap=100;
let loseStreak=0;
let timer=null;

const acc=document.getElementById("account");
const dd=document.getElementById("dd");
const capEl=document.getElementById("cap");
const cnt=document.getElementById("count");
const log=document.getElementById("log");
const verdictBox=document.getElementById("verdict");

const start=document.getElementById("start");
const cut=document.getElementById("cut");
const hold=document.getElementById("hold");

function updateDD(){
  const d=((peak-account)/peak*100);
  maxDD=Math.max(maxDD,d);
  return maxDD.toFixed(1);
}

function position(){
  let base=20;
  if(loseStreak>=2) base=50;
  if(loseStreak>=3) base=100;
  return Math.min(base,cap);
}

function update(){
  acc.innerText=account.toFixed(1);
  dd.innerText=updateDD();
  capEl.innerText=cap;
  cnt.innerText=count;
}

function irreversiblePenalty(type){
  if(type==="holdFail"){
    cap=Math.max(20,cap-20);
    log.innerText+="\nâš ï¸ ä¸å¯é€†æƒ©ç½šï¼šæœ€å¤§ä»“ä½æ°¸ä¹…é™ä¸º "+cap+"%";
  }
  if(type==="hesitate"){
    cap=Math.max(20,cap-10);
    log.innerText+="\nâš ï¸ ä¸å¯é€†æƒ©ç½šï¼šçŠ¹è±«ä¸€æ¬¡ï¼Œæœªæ¥æ›´éš¾ç¿»èº«";
  }
}

function generateVerdict(){
  let level="", text="";
  if(account<=0){
    level="ğŸ”´ ç»ˆå®¡åˆ¤å†³ï¼šæ·˜æ±°";
    text="ä½ ä¸æ˜¯è¾“åœ¨è¿™ä¸€æŠŠã€‚\nä½ æ˜¯ç”¨ä¸€æ¬¡æ¬¡é”™è¯¯ï¼Œä¸»åŠ¨å‰¥å¤ºäº†æœªæ¥çš„é€‰æ‹©æƒã€‚";
  }else if(cap<=40){
    level="ğŸŸ¡ ç»ˆå®¡åˆ¤å†³ï¼šè¢«å¸‚åœºé©¯åŒ–";
    text="ä½ è¿˜æ´»ç€ï¼Œä½†å·²ç»æ²¡æœ‰è¿›æ”»èƒ½åŠ›ã€‚\nå¸‚åœºå…è®¸ä½ å­˜åœ¨ï¼Œä½†ä¸å…è®¸ä½ ç¿»èº«ã€‚";
  }else if(count>=50){
    level="ğŸŸ¢ ç»ˆå®¡åˆ¤å†³ï¼šåˆæ ¼å¹¸å­˜è€…";
    text="ä½ æ²¡æœ‰è¿½æ±‚ç¿»ç›˜ã€‚\nä½ åªæ˜¯æ‹’ç»çŠ¯è‡´å‘½é”™è¯¯ã€‚";
  }else{
    level="âšª ç»ˆå®¡åˆ¤å†³ï¼šæœªå®Œæˆæ ·æœ¬";
    text="ä½ å°šæœªèµ°åˆ°è¶³å¤Ÿè¿œçš„åœ°æ–¹ã€‚";
  }

  verdictBox.innerText=level+"\n\n"+text+
    "\n\næœ€ç»ˆè´¦æˆ·ï¼š"+account.toFixed(1)+"%"+
    "\næœ€å¤§å›æ’¤ï¼š"+maxDD.toFixed(1)+"%"+
    "\nå‰©ä½™æœ€å¤§ä»“ä½ï¼š"+cap+"%"+
    "\näº¤æ˜“æ¬¡æ•°ï¼š"+count;
  verdictBox.style.display="block";
}

function endGame(text){
  clearTimeout(timer);
  cut.classList.add("hidden");
  hold.classList.add("hidden");
  start.classList.remove("hidden");
  log.innerText=text+"\näº¤æ˜“ç»“æŸ";
  generateVerdict();
}

function next(){
  count++;
  update();
  verdictBox.style.display="none";

  let delay=900;
  if(maxDD>=10) delay=700;
  if(maxDD>=20) delay=500;

  timer=setTimeout(()=>{
    log.innerText="âŒ çŠ¹è±«ä¸å†³ï¼Œæœºä¼šæµå¤±";
    irreversiblePenalty("hesitate");
    endGame("å¸‚åœºä¸å†ç»™ä½ æ—¶é—´");
  },delay);
}

cut.onclick=()=>{
  clearTimeout(timer);
  const loss=position()/100;
  account-=loss;
  loseStreak++;
  log.innerText="ğŸ§  æ­¢æŸæ‰§è¡Œï¼Œå°äºæ¢ç”Ÿå­˜";
  if(account<=0) endGame("ğŸ’€ èµ„é‡‘è€—å°½");
  else next();
};

hold.onclick=()=>{
  clearTimeout(timer);
  let boomRate=0.7;
  if(loseStreak>=2) boomRate+=0.2;

  if(Math.random()<boomRate){
    account-=position();
    loseStreak++;
    log.innerText="ğŸ’¥ æ‰›å•å¤±è´¥ï¼Œé”™è¯¯å·²è®°å½•";
    irreversiblePenalty("holdFail");
    if(account<=0) endGame("ğŸ’€ çˆ†ä»“");
    else next();
  }else{
    account+=position()*0.25;
    loseStreak=0;
    peak=Math.max(peak,account);
    log.innerText="ğŸš€ æ‰›å•æˆåŠŸï¼Œä½†ä»£ä»·æœªæ¥å¯è§";
    next();
  }
};

start.onclick=()=>{
  account=100;peak=100;maxDD=0;count=0;cap=100;loseStreak=0;
  start.classList.add("hidden");
  cut.classList.remove("hidden");
  hold.classList.remove("hidden");
  verdictBox.style.display="none";
  log.innerText="ä½ å·²ç­¾ç½²å£°æ˜ï¼š\né”™è¯¯å°†æ°¸ä¹…æ”¹å˜ä½ æœªæ¥çš„é€‰æ‹©";
  next();
};
</script>

</body>
</html>
